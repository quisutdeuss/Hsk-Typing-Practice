# HSK 拼音打字练习网站开发文档

## 项目概述

这是一个在线HSK汉字打字练习网站，帮助用户通过打字练习来学习HSK 1-6级以及HSK 7+级的词汇。

## 当前功能状态

### ✅ 已完成功能

1. 用户界面
   - 简洁现代的设计风格
   - 响应式布局，适应不同屏幕尺寸
   - 支持深色/浅色主题切换
   - 主题偏好保存在本地存储

2. HSK级别选择
   - 提供HSK 1-6级和HSK 7+级的选择按钮
   - 每个级别按钮有独特的颜色标识
   - 当前选中级别高亮显示

3. 词汇练习
   - 从选定的HSK级别中加载完整词库
   - 使用Fisher-Yates算法随机打乱词序
   - 显示汉字，要求用户输入对应的中文
   - 提供可切换的拼音提示（小眼睛按钮）
   - 拼音显示偏好保存在本地存储

4. 用户认证系统
   - 邮箱注册/登录功能
   - Google账号登录集成
   - 密码重置功能
   - 用户登录状态维护
   - 安全退出功能

5. 多语言支持
   - 支持中文、英文和越南语界面
   - 语言切换不影响练习进度
   - 语言偏好保存在本地存储
   - 根据语言自动调整问候语

### 🔄 待实现功能

1. 练习历史记录（优先级：高）
   - 用户练习历史的记录和展示
   - 练习时长统计
   - 每日/每周/每月练习数据统计
   - 练习记录导出功能

2. 错题集功能（优先级：高）
   - 错题自动收集
   - 错题分类管理
   - 针对性练习模式
   - 错题分析报告

3. 详细统计数据（优先级：中）
   - 正确率统计
   - 平均用时分析
   - 进步趋势图表
   - 词汇量增长曲线
   - 薄弱点分析

4. 自定义练习模式（优先级：中）
   - 自定义词库创建
   - 导入/导出词库
   - 生词本功能
   - 智能复习提醒

5. AI助手功能优化（优先级：低）
   - 改进对话上下文理解
   - 添加练习建议功能
   - 智能纠错功能
   - 个性化学习计划

## 近期开发计划

### 第一阶段（1-2周）

1. 实现练习历史记录功能
   - 设计数据库结构
   - 实现数据记录功能
   - 开发历史记录展示界面
   - 添加数据分析功能

2. 开发错题集功能
   - 错题自动收集机制
   - 错题复习模式
   - 错题分析统计

### 第二阶段（2-3周）

1. 增加详细统计功能
   - 实现各类统计图表
   - 添加进度分析
   - 开发数据可视化界面

2. 优化用户体验
   - 改进界面交互
   - 添加动画效果
   - 优化移动端适配

### 第三阶段（3-4周）

1. 开发自定义练习功能
   - 实现词库管理
   - 添加生词本功能
   - 开发智能复习系统

2. 完善AI助手功能
   - 优化对话体验
   - 添加智能建议
   - 实现个性化辅导

## 技术栈

- 前端：HTML5, CSS3, JavaScript
- 后端：Node.js, Express.js
- 数据库：Firebase Realtime Database
- 认证：Firebase Authentication
- 部署：Vercel

## 项目结构

## 开发过程中遇到的问题及解决方案

### 1. Firebase 配置安全性问题

**问题描述：**

- 最初考虑将 Firebase 配置信息设置为环境变量
- 尝试使用 .env 文件和环境变量管理配置

**解决方案：**

- Firebase 配置值（apiKey 等）本质上是公开的，不是敏感信息
- 真正的安全保护来自于 Firebase Console 中的设置：
  - 授权域名限制
  - 安全规则
  - 认证设置
- 直接在 firebase-config.js 中使用实际配置值
- 在 Firebase Console 中正确配置安全规则和域名限制

### 2. AI 聊天功能的 CORS 问题

**问题描述：**

- 本地开发时 AI 聊天功能无法正常工作
- API 请求被 CORS 策略阻止
- 生产环境（Vercel）中正常工作

**解决方案：**

- 创建本地代理服务器（server.js）来转发请求
- 使用 Express 搭建简单的代理服务器
- 配置相关的开发命令：

  ```json
  {
    "scripts": {
      "start": "nodemon server.js",  // 开发模式，自动重启
      "serve": "node server.js",     // 生产模式
      "dev": "nodemon server.js"     // 开发模式别名
    }
  }
  ```

### 3. 开发环境配置

**本地开发流程：**

1. 使用 `npm start` 启动开发服务器（支持自动重启）
2. 通过 `http://localhost:3000` 访问应用
3. 修改代码后服务器自动重启

**生产环境部署：**

1. 在 Vercel 中配置必要的环境变量
2. 配置允许的域名在 Firebase Console 中
3. 确保安全规则正确设置

### 4. 项目文件结构优化

**最终的文件结构：**
