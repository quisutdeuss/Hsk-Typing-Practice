# HSK 拼音打字练习网站开发文档

## 项目概述

这是一个在线HSK汉字打字练习网站，帮助用户通过打字练习来学习HSK 1-6级以及HSK 7+级的词汇。

## 已实现功能

1. 用户界面
   - 简洁现代的设计风格
   - 响应式布局，适应不同屏幕尺寸
   - 支持深色/浅色主题切换
   - 主题偏好保存在本地存储

2. HSK级别选择
   - 提供HSK 1-6级和HSK 7+级的选择按钮
   - 每个级别按钮有独特的颜色标识
   - 当前选中级别高亮显示

3. 词汇练习
   - 从选定的HSK级别中加载完整词库
   - 使用Fisher-Yates算法随机打乱词序
   - 显示汉字，要求用户输入对应的中文
   - 提供可切换的拼音提示（小眼睛按钮）
   - 拼音显示偏好保存在本地存储

4. 答案检查
   - 实时检查用户输入是否正确
   - 错误时显示正确答案提示
   - 提示框5秒后自动消失
   - 支持回车键和提交按钮两种提交方式

5. 进度跟踪
   - 显示当前得分
   - 显示练习进度（当前词/词库总词数）
   - 完成一轮后显示总成绩

6. AI助手功能
   - 集成DeepSeek API的AI对话功能
   - 支持实时对话
   - 保持对话历史
   - 支持回车键快速发送消息

7. 多语言支持
   - 支持中文、英文和越南语界面
   - 语言切换不影响练习进度
   - 语言偏好保存在本地存储

8. 错误处理
   - 词库加载失败提示
   - 网络请求错误提示
   - API调用失败提示

## 技术栈

- 前端：HTML5, CSS3, JavaScript
- 后端：Node.js, Express.js
- API：DeepSeek AI API
- 数据存储：JSON文件
- 部署：Vercel

## 文件结构

- `public/`
  - `index.html`: 主HTML文件
  - `styles.css`: 样式表
  - `app.js`: 前端JavaScript逻辑
- `data/`
  - `HSK_1.json`, `HSK_2.json`, ...: HSK词汇数据文件
- `server.js`: Node.js服务器文件
- `package.json`: 项目依赖配置文件

## 待实现功能

1. 用户认证系统
2. 练习历史记录
3. 错题集功能
4. 更多统计数据（如正确率、平均用时等）
5. 自定义练习模式（如只练习某些特定类型的词）

## 如何运行

1. 确保安装了Node.js
2. 在项目根目录运行 `npm install` 安装依赖
3. 运行 `node server.js` 启动服务器
4. 在浏览器中访问 `http://localhost:3000`

## 项目结构

## 最新改进

1. 词库练习功能优化
   - 添加了HSK 7+级别的词库支持
   - 修改进度显示，使用实际词库大小而不是固定的20个词
   - 添加了词库练习完成后自动重新打乱继续的功能
   - 完成提示会显示2秒后自动开始新一轮

2. 加载状态优化
   - 添加了词库加载中的状态提示
   - 优化了加载失败时的错误提示
   - 添加了文件名检查和数据格式验证

3. 错误处理优化
   - 改进了错误提示的显示方式
   - 添加了5秒后自动消失的错误提示
   - 优化了错误提示的样式和动画效果

4. 界面交互优化
   - 改进了按钮的禁用状态样式
   - 优化了输入框的焦点处理
   - 改进了键盘事件的处理逻辑

## 待修复问题

1. 语言切换功能异常
   - 右上角语言切换按钮点击无反应
   - 需要修复语言切换的事件监听器

## 最新更新 (2024-03)

1. 修复的问题
   - 修复了拼音显示切换按钮（小眼睛）消失的问题
   - 修复了语言切换功能不生效的问题
   - 修复了词库加载状态提示的显示问题

2. 新增功能
   - 添加了HSK 7+级别的词库支持
   - 添加了练习完成后自动重新开始的功能
   - 添加了词库加载状态的提示
   - 优化了错误提示的显示方式

3. 功能优化
   - 改进了进度显示，使用实际词库大小
   - 优化了拼音显示切换的用户体验
   - 改进了多语言切换的实现
   - 优化了错误提示的样式和动画

4. 代码优化
   - 删除了冗余的语言切换代码
   - 优化了事件监听器的处理
   - 改进了HTML结构的维护方式
   - 优化了状态管理逻辑

## 当前功能状态

1. 核心功能
   - ✅ HSK 1-6级词库练习
   - ✅ HSK 7+级词库练习
   - ✅ 拼音显示切换
   - ✅ 自动重新开始练习
   - ✅ 多语言支持

2. 用户界面
   - ✅ 深色/浅色主题切换
   - ✅ 响应式布局
   - ✅ 加载状态提示
   - ✅ 错误提示动画

3. AI助手功能
   - ✅ 实时对话支持
   - ✅ 多语言回答
   - ✅ 上下文理解

## 后续计划

1. 性能优化
   - [ ] 添加词库预加载
   - [ ] 优化大型词库的处理
   - [ ] 改进状态管理

2. 功能扩展
   - [ ] 添加练习统计功能
   - [ ] 支持自定义词库
   - [ ] 添加生词本功能

3. 用户体验
   - [ ] 添加进度保存功能
   - [ ] 优化移动端适配
   - [ ] 添加键盘快捷键
